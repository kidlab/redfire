<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
 	xmlns:u="com.salesbuilder.util.*" 
 	xmlns:dv="com.salesbuilder.dataviz.*" 
	width="100%" height="100%" 
	backgroundAlpha="0"
	icon="@Embed('/assets/icon_opportunity.png')"
	label="Transfers">
	
	<mx:Script>
		<![CDATA[

		import com.salesbuilder.control.TabManager;
		import mx.collections.ArrayCollection;

		[Bindable] private var opportunities:ArrayCollection;
		
		private function dgCurrencyFormat(item:Object, column:Object):String
		{
		    return String(item[column.dataField]);
		}

		private function dgPercentFormat(item:Object, column:DataGridColumn):String
		{
			return item[column.dataField];
		}

		private function dgDateFormat(item:Object, column:DataGridColumn):String
		{
			return String(new Date(item[column.dataField]));
		}
		
		
        ]]>

    </mx:Script>

	<u:DragExcel dataGrid="{dg}"/>

    <mx:CurrencyFormatter id="cf"/>
    <mx:DateFormatter id="df"/>
	
	<mx:HBox width="100%" height="100%" paddingTop="12" paddingBottom="8" paddingLeft="8" paddingRight="8" horizontalGap="20">
		
		<mx:VBox width="60%" height="100%" verticalGap="4">

			<dv:Dashboard id="dashboard" height="65%"/>			
			
			<mx:Spacer height="8"/>
			
			<mx:Label styleName="title" text="Recent Activity"/>
	
			<mx:DataGrid width="100%" height="35%">
				<mx:columns>
					<mx:DataGridColumn dataField="name" headerText="Customer"/>
					<mx:DataGridColumn dataField="date" headerText="Date"/>
					<mx:DataGridColumn dataField="author" headerText="Agent"/>
				</mx:columns>
			</mx:DataGrid>
	
		</mx:VBox>

		<mx:VBox width="40%" height="100%">
			
			<mx:Label styleName="title" text="All Money Transfers"/>
			
			<mx:DataGrid id="dg" dataProvider="{dashboard.opportunities}" width="100%" height="100%" doubleClickEnabled="true" 
				doubleClick="TabManager.openOpportunityById(dg.selectedItem.opportunityId)" allowMultipleSelection="true">
				<mx:columns>
					<mx:DataGridColumn width="120" dataField="name" headerText="Transaction"/>
					<mx:DataGridColumn width="20" dataField="probability" headerText="Transfer Fee" labelFunction="dgPercentFormat" textAlign="right" paddingRight="8"/>
					<mx:DataGridColumn width="20" dataField="expectedAmount" headerText="Total Amount" textAlign="right" labelFunction="dgCurrencyFormat" paddingRight="8"/>
					<mx:DataGridColumn width="40" dataField="expectedCloseDate" headerText="Date" labelFunction="dgDateFormat"/>
				</mx:columns>
			</mx:DataGrid>

		</mx:VBox>

	</mx:HBox>
	
</mx:Canvas>